\begin{frame}[fragile]{\WaitGroup}
   \textbf{用途}: 等待一批并发操作结束，\alert{操作的结果不是关心的重点或者能够通过其他途径收集} 

   \begin{columns}[t]
       \column{0.5\textwidth}
\begin{lstlisting}[xleftmargin=8pt]
var wg sync.WaitGroup

wg.Add(1)
go func() {
  defer wg.Done()
  fmt.Println("Alice sleeping...")
  time.Sleep(1)
}()

wg.Add(1)
go func() {
  defer wg.Done()
  fmt.Println("Bob sleeping...")
\end{lstlisting}

       \column{0.5\textwidth}
\begin{lstlisting}[firstnumber=last,xleftmargin=16pt]
  time.Sleep(2)
}()
wg.Wait()
fmt.Println("Both are awaken.")

// 输出:
// Bob sleeping...
// Alice sleeping...
// Both are awaken.
\end{lstlisting}
   \end{columns}
\end{frame}

\begin{frame}{\WaitGroup}
    \WaitGroup 可看作一个线程安全的计数器

    \begin{itemize}
        \item 通过 \texttt{Add(x)}加上特定数\texttt{x}
        \item 通过 \texttt{Done()}使其减1
        \item \texttt{Wait()}使其一直阻塞直至计数器置零
    \end{itemize}

    \begin{alertblock}{温馨提示}
        \texttt{Add()}需要在\WaitGroup 协调的协程之外(一般使主协程)调用，否则将引入\alert{竞态}
    \end{alertblock}
\end{frame}